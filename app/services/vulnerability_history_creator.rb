class VulnerabilityHistoryCreator
  def create(kind_history, vulnerability)
    case kind_history
    when 'create'
      VulnerabilityHistory.create(
        status_quo: Vulnerability.statuses[vulnerability.status.to_sym],
        vulnerability_creation: vulnerability.created_at,
        vulnerability:,
        user_id: vulnerability.user_id
      )
    when 'update'
      return unless vulnerability.saved_change_to_status?

      VulnerabilityHistory.create(
        old_status: Vulnerability.statuses[vulnerability.status_before_last_save.to_sym],
        status_quo: Vulnerability.statuses[vulnerability.status.to_sym],
        vulnerability:,
        user_id: vulnerability.user_id
      )
    end
  end
end
